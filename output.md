### srcs/.env
```
DOMAIN_NAME=seokjyan.42.fr

# certificates
SSL_CERT='-----BEGIN CERTIFICATE-----
MIIDazCCAlOgAwIBAgIUIDon4dpuTnI17ZKDneUjzjgb5f0wDQYJKoZIhvcNAQEL
BQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoM
GEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDAeFw0yNDA4MjYxNDU0NDBaFw0yNTA4
MjYxNDU0NDBaMEUxCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEw
HwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQwggEiMA0GCSqGSIb3DQEB
AQUAA4IBDwAwggEKAoIBAQCuGk/KR5YWbaJWw7CwBotBBF2dVm2cYkdMrdOZ42Ip
ZUntCCjkbRT2M5wlqABxb64ll6Yr4KYJroNYyF8O0FMEVnfMN5EGQ37rvdD0Zw0u
SFEULSj2MFBuzpKl7ERIGxWqoXv91FHhEuRW4zIRxMTRMEwxDH8FTEVO11yXB/h7
7VBoHx58W0PhEhaGvnEdVM2tTACAqvRidCMf8H7lqEH545vywpSBu4yKMTm4DZhn
j0ovp2N0bbpJQCvDorOg2Xe8XCvZ+EXDpmzxoYHhssVzHkUESirnNWbFLBIuYFOs
o04FSXH7xCowKP7uoL3FEKFJuODIBoI+QQNmHtgDGrj7AgMBAAGjUzBRMB0GA1Ud
DgQWBBQluQ1aFjjZpfL3ZxYHbmv+fJOD5jAfBgNVHSMEGDAWgBQluQ1aFjjZpfL3
ZxYHbmv+fJOD5jAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQA4
TOZsl/zvXzoBmAgILIIOC87T7bJUb4cRAXXIvUDqvg7/zoMBR3OWj48pCCzmpl0q
ZdNV9hUr+BirMmHsGjT4j+vyFHBjQtqqyhBXFKtvTFbDhFl0AYB+/tn7DCMtOhGz
XDbBhN8oN9J9Hi/OF8meu6LSoSZmjBLDjAF392yRHMcI3/SFmG/aIcoOeuyzU+E4
jYvT0yJP3/AyIhb5g8GbmUnvseBuA30gOu+LZbp9Ia/yRNRo5C6VuIX+qjFCk0id
1ORFtep6w33spaa4rLqE4WZdz0PP6G5mrcGZyjstdS17X7hMLetSXxXSO+dVZfjC
DAOQqC0TtGXGY3BPyJa4
-----END CERTIFICATE-----'
SSL_KEY='-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCuGk/KR5YWbaJW
w7CwBotBBF2dVm2cYkdMrdOZ42IpZUntCCjkbRT2M5wlqABxb64ll6Yr4KYJroNY
yF8O0FMEVnfMN5EGQ37rvdD0Zw0uSFEULSj2MFBuzpKl7ERIGxWqoXv91FHhEuRW
4zIRxMTRMEwxDH8FTEVO11yXB/h77VBoHx58W0PhEhaGvnEdVM2tTACAqvRidCMf
8H7lqEH545vywpSBu4yKMTm4DZhnj0ovp2N0bbpJQCvDorOg2Xe8XCvZ+EXDpmzx
oYHhssVzHkUESirnNWbFLBIuYFOso04FSXH7xCowKP7uoL3FEKFJuODIBoI+QQNm
HtgDGrj7AgMBAAECggEABNrX+cCIR2TUP44iaa4tCOmZwK7tzIwTB+ja+zIThSr9
Zj4xgbkm+fyTcJtgM8mU9hhl+lg/2QpEQGAKAow9nGPa4Fd2VFHigqle38nV3MII
fMMLnt3XCFf7T+QoPUiAEKuDHR9kDx4rPt8EAOnXQSwTG9UI37lyP1ITE2UWAUKf
iZ1nKXJ/UW06GvQFSrTYk4skCrYdUp8Wara3bT7Ud5gu/bhA755wpc2A+3u1QIs2
4mBVq8a3U2F0o+pE6rzIuzz4XSEYGe5EK5SDQO8IQmoZphWL/4hH3y3BELf9ZNJO
y0SmBXr2yMV6igN/U7knuh/+SMem0isWTCKG7k4DVQKBgQDkJNqHWp4ufrl2W5nY
wy6YOIogBOVmz+X2vo7ebAf7LGbZOy2xG990N5Ek8gN7sXQKYRIPKUjT1x21MZnp
6OFspxd251TAtUzbfpH6wTlzRhrJYKh51ulgl01bf1iNJcWK1srNIDArKQVHWJYw
aGIYp2tZGGKByxap7doMEeTYzwKBgQDDXEfp3wmH+2Eqi1yX+FpHnLhozdZ/h/3i
KiubBGlVqXcTRyGmITyk7mAX/05wcfYRSXmEL6JCZWrz5Fhgy9UY4MeHeiyOycxZ
7a1IlnP4h+BiMD8h44Btoq5H8998cygPTjs5U6FoMlFpEjgH+RX9xf4vrSDM/rM2
6JGxR7gQFQKBgG6IjHfXp5vPOfvmFXu31PNbMVCiDqLpRvltCbspjBRdRtconNKa
NoEQCvpjZtye9SGyNhWyYt5/8py/E1sIwW7q5atuGNnk/P+7Ku7afwMijAfVFMsz
HI73vzr9T+HS0wqZVlhbp/rBPRV8DggWCrD3LENWVSOdSbW6z1HZuY5xAoGAahgI
eesFWxLajudGLsXSCYgD4e6/KV0qNJPgQHxh1AKHRzHfBUCRlaRbDU06RPiuwG6d
jnrr7JD1R2Rf1pl7rdoMofdokVboIoJgE8aZToRECC7ZakcJrQCnEy5O1WAYhk9e
/F/9jP+elKgvQ60zEzFePHgSEyHTI+Ojk5o2TI0CgYEAnLp9/qUEG0jCgfAvWwlY
QpYndrq9N/ujb5Cbybomiz03pz5DwWaKUhCVSF55uTb4GoTh19XS9XNCdZETnirb
RNwjPpcPinjGrABst1tH9WSpnAK9CFuaeL1N8frQO/jW16lPGcdv2dcRp9l4ds+N
oL7bLoKMZpuiqDG3aObgGdc=
-----END PRIVATE KEY-----'

# MARIADB SETUP
MYSQL_PWD=1234

# WORDPRESS SETUP
WORDPRESS_DB_HOST=mariadb:3306
WORDPRESS_DB_USER=seokjyan
WORDPRESS_DB_PASSWORD=1234
WORDPRESS_DB_NAME=mydatabase

```

### srcs/docker-compose.yml
```.yml
services:
  # mariadb:
  #   # image: mariadb # 이미지 이름만 바꾸고싶은데... 임시방편으로 발라놈... 고치는거 알려줘...
  #   container_name: mariadb
  #   restart: always
  #   # restart: on-failure
  #   build:
  #     context: requirements/mariadb
  #   cap_add:
  #     - SYS_ADMIN
  #   env_file:
  #     - .env
  #   volumes:
  #     - db_volume:/var/lib/mysql
  #   networks:
  #     - seokyangNet
  #   expose:
  #     - "3306"

  wordpress:
    container_name: wordpress
    restart: always
    build:
      context: requirements/wordpress
    env_file:
      - .env
    volumes:
      - wp_volume:/var/www/html
    # depends_on:
    #   - mariadb
    networks:
      - seokyangNet
    expose:
      - "9000"

  nginx:
    container_name: nginx
    restart: always
    build:
      context: requirements/nginx
    env_file:
      - .env
    volumes:
      - wp_volume:/var/www/html:ro # Read-Only로 마운트
    depends_on:
      - wordpress
    networks:
      - seokyangNet
    ports:
      - "443:443"

volumes:
  wp_volume:
    name: wp_volume
    driver: local
    driver_opts:
      type: none
      device: /Users/seokjyan/data/wordpress
      o: bind
  db_volume:
    name: db_volume
    driver: local
    driver_opts:
      type: none
      device: /Users/seokjyan/data/mariadb
      o: bind

networks:
  seokyangNet:
    driver: bridge

```

### srcs/requirements/mariadb/Dockerfile
```
# Base image
FROM alpine:3.20

# Install MariaDB
RUN apk update && \
    apk add --no-cache mariadb mariadb-client

# Create necessary directories and set permissions
RUN mkdir -p /var/lib/mysql /var/log/mysql /run/mysqld && \
    chown -R mysql:mysql /var/lib/mysql /var/log/mysql /run/mysqld

# Copy MariaDB configuration

# Initialize MariaDB database
# RUN mysql_install_db --user=mysql --basedir=/usr --datadir=/var/lib/mysql

# 임시 주석
# Copy initialization scripts
# COPY conf/my.cnf /etc/mysql/my.cnf.d/
# COPY ./conf/my.cnf /etc/my.cnf.d/
COPY ./tools /var/www/tools

# Ensure initialization scripts have execution permissions
# RUN chmod 644 /etc/my.cnf.d/my.cnf
RUN chmod +x /var/www/tools/init_db.sql
RUN chmod +x /var/www/tools/entrypoint.sh

# Run MariaDB server and initialize database
ENTRYPOINT ["/var/www/tools/entrypoint.sh"]

# Default command
CMD ["mysqld"]


# RUN echo "This is a log file" > /var/log/mylog.log
# ENTRYPOINT ["tail", "-f", "/var/log/mylog.log"]

```

### srcs/requirements/mariadb/tools/init_db.sql
```.sql
-- init_db.sql

-- DB 생성
CREATE DATABASE IF NOT EXISTS wpdb;

-- 계정 생성 및 패스워드 설정
CREATE USER IF NOT EXISTS 'seokjyan'@'localhost' IDENTIFIED BY '1234';

-- 계정이 DB에 접근할 수 있는 모든 권한 부여
GRANT ALL ON wpdb.* TO 'seokjyan'@'localhost' IDENTIFIED BY '1234' WITH GRANT OPTION;

-- 설정을 마침 권한을 적용
FLUSH PRIVILEGES;

-- 종료
exit

-- 조회 관련 명령어
-- SELECT USER(); -- 현재 접속한 계정 정보
-- SHOW DATABASES; -- DB 목록 조회
-- SHOW GRANTS FOR 'seokjyan'@'localhost'; -- 계정 권한 조회
-- SELECT User, Host FROM mysql.user; -- 계정 목록 조회

```

### srcs/requirements/mariadb/tools/entrypoint.sh
```.sh
#!/bin/sh
# 명령이 실패하면 스크립트를 종료합니다
set -e

# MariaDB를 백그라운드에서 시작합니다
mariadbd --user=mysql &

# MariaDB가 시작될 때까지 잠시 기다립니다
sleep 10

# # 데이터베이스를 초기화합니다
rm -rf /var/lib/mysql/*
mysql_install_db --user=mysql --basedir=/usr --datadir=/var/lib/mysql
mysql -u root < /var/www/tools/init_db.sql

# # 초기화 스크립트를 삭제합니다
# rm -f /var/www/tools/init_db.sql

# Wait for MariaDB to be ready and then bring it to the foreground
wait

```

### srcs/requirements/mariadb/conf/my.cnf
```.cnf

   
#
#These groups are read by MariaDB server.
#Use it for options that only the server (but not clients) should see
#
#See the examples of server my.cnf files in /usr/share/mysql

#this is read by the standalone daemon and embedded servers
[server]

#this is only for the mysqld standalone daemon
[mysqld]

#
# * Basic Settings
#
user                    = mysql
pid-file                = /run/mysqld/mysqld.pid
socket                  = /run/mysqld/mysqld.sock
port                    = 3306
basedir                 = /usr
datadir                 = /var/lib/mysql
tmpdir                  = /tmp
lc-messages-dir         = /usr/share/mysql
#skip-external-locking

#Instead of skip-networking the default is now to listen only on
#localhost which is more compatible and is not less secure.
#bind-address            = 127.0.0.1

#
# * Fine Tuning
#
#key_buffer_size        = 16M
#max_allowed_packet     = 16M
#thread_stack           = 192K
#thread_cache_size      = 8
# This replaces the startup script and checks MyISAM tables if needed
# the first time they are touched
#myisam_recover_options = BACKUP
#max_connections        = 100
#table_cache            = 64
#thread_concurrency     = 10

#
# * Query Cache Configuration
#
#query_cache_limit      = 1M
query_cache_size        = 16M

#
# * Logging and Replication
#
# Both location gets rotated by the cronjob.
# Be aware that this log type is a performance killer.
# As of 5.1 you can enable the log at runtime!
#general_log_file       = /var/log/mysql/mysql.log
#general_log            = 1
#
# Error log - should be very few entries.
#
log_error = /var/log/mysql/error.log
#
# Enable the slow query log to see queries with especially long duration
#slow_query_log_file    = /var/log/mysql/mariadb-slow.log
#long_query_time        = 10
#log_slow_rate_limit    = 1000
#log_slow_verbosity     = query_plan
#log-queries-not-using-indexes
#
# The following can be used as easy to replay backup logs or for replication.
# note: if you are setting up a replication slave, see README.Debian about
#       other settings you may need to change.
#server-id              = 1
#log_bin                = /var/log/mysql/mysql-bin.log
expire_logs_days        = 10
#max_binlog_size        = 100M
#binlog_do_db           = include_database_name
#binlog_ignore_db       = exclude_database_name

#
# * Security Features
#
# Read the manual, too, if you want chroot!
#chroot = /var/lib/mysql/
#
# For generating SSL certificates you can use for example the GUI tool "tinyca".
#
#ssl-ca = /etc/mysql/cacert.pem
#ssl-cert = /etc/mysql/server-cert.pem
#ssl-key = /etc/mysql/server-key.pem
#
# Accept only connections using the latest and most secure TLS protocol version.
# ..when MariaDB is compiled with OpenSSL:
#ssl-cipher = TLSv1.2
# ..when MariaDB is compiled with YaSSL (default in Debian):
#ssl = on

#
# * Character sets
#
# MySQL/MariaDB default is Latin1, but in Debian we rather default to the full
# utf8 4-byte character set. See also client.cnf
#
character-set-server  = utf8mb4
collation-server      = utf8mb4_general_ci

#
# * InnoDB
#
# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/.
# Read the manual for more InnoDB related options. There are many!

#
# * Unix socket authentication plugin is built-in since 10.0.22-6
#
# Needed so the root database user can authenticate without a password but
# only when running as the unix root user.
#
# Also available for other users if required.
# See https://mariadb.com/kb/en/unix_socket-authentication-plugin/

# this is only for embedded server
[embedded]

# This group is only read by MariaDB servers, not by MySQL.
# If you use the same .cnf file for MySQL and MariaDB,
# you can put MariaDB-only options here
[mariadb]

# This group is only read by MariaDB-10.3 servers.
# If you use the same .cnf file for MariaDB of different versions,
# use this group for options that older servers don't understand
[mariadb-10.3]
```

### srcs/requirements/mariadb/conf/mariadb-server.cnf
```.cnf
#
# These groups are read by MariaDB server.
# Use it for options that only the server (but not clients) should see

# this is read by the standalone daemon and embedded servers
[server]

# this is only for the mysqld standalone daemon
[mysqld]
skip-networking

# Galera-related settings
[galera]
# Mandatory settings
#wsrep_on=ON
#wsrep_provider=
#wsrep_cluster_address=
#binlog_format=row
#default_storage_engine=InnoDB
#innodb_autoinc_lock_mode=2
#
# Allow server to accept connections on all interfaces.
#
#bind-address=0.0.0.0
#
# Optional setting
#wsrep_slave_threads=1
#innodb_flush_log_at_trx_commit=0

# this is only for embedded server
[embedded]

# This group is only read by MariaDB servers, not by MySQL.
# If you use the same .cnf file for MySQL and MariaDB,
# you can put MariaDB-only options here
[mariadb]

# This group is only read by MariaDB-10.5 servers.
# If you use the same .cnf file for MariaDB of different versions,
# use this group for options that older servers don't understand
[mariadb-10.5]
```

### srcs/requirements/wordpress/Dockerfile
```
# # Base image
# FROM alpine:3.19

# # 필요한 패키지 설치
# RUN	apk update && apk add --no-cache sudo
# RUN	apk add --no-cache bash

# # phpMyAdmin 설치
# RUN apk add --no-cache wget
# RUN wget -O /tmp/phpmyadmin.tar.gz "https://files.phpmyadmin.net/phpMyAdmin/5.2.0/phpMyAdmin-5.2.0-all-languages.tar.gz"
# RUN mkdir -p /var/www/html/phpmyadmin
# RUN tar -xvzf /tmp/phpmyadmin.tar.gz -C /var/www/html/phpmyadmin
# RUN rm -rf /tmp/phpmyadmin.tar.gz
# RUN apk add --no-cache php82-common php82-fpm php82-mysqli php82-curl

# # sudo 설정 파일 수정: root 사용자에게 sudo 권한 부여
# RUN echo 'root ALL=(ALL) ALL' > /etc/sudoers.d/roo

# # 로그 파일 생성

# # ENTRYPOINT 설정 - tail 명령어로 로그 파일을 계속해서 출력, 무한히 실행
# ENTRYPOINT ["tail", "-f", "/var/log/mylog.log"]

FROM alpine:3.20

# 설치에 필요한 패키지 업데이트 및 설치
RUN apk update && apk add --no-cache \
	php82-common \
	php82-fpm \
	php82-mysqli \
	php82-curl \
	wget

# 설정 파일 및 도구 복사
COPY ./conf/my.conf /etc/php82/conf.d/
COPY ./tools /var/www/tools

# 스크립트에 실행 권한 부여
RUN chmod +x /var/www/tools/entrypoint.sh

# entrypoint.sh 실행
ENTRYPOINT [ "/bin/sh", "/var/www/tools/entrypoint.sh" ]

# CMD ["/usr/sbin/php-fpm82", "--nodaemonize"]

# RUN echo "This is a log file" > /var/log/mylog.log
# ENTRYPOINT ["tail", "-f", "/var/log/mylog.log"]

```

### srcs/requirements/wordpress/tools/entrypoint.sh
```.sh
#!/bin/bash
set -e

# 워드프레스를 다운로드하고 압축을 풉니다
# wget -O /tmp/wordpress.tar.gz "http://wordpress.org/latest.tar.gz"
# tar -xvzf /tmp/wordpress.tar.gz --strip-components=1 -C /var/www/html


wget -O /tmp/wordpress.tar.gz "http://wordpress.org/latest.tar.gz"
tar --strip-components=1 -xvzf /tmp/wordpress.tar.gz -C /var/www/html

php-fpm82 --nodaemonize
```

### srcs/requirements/wordpress/conf/my.conf
```.conf
[www]
user = www-data
group = www-data
listen = wordpress:9000
pm = dynamic
pm.start_servers = 6
pm.max_children = 25
pm.min_spare_servers = 2
pm.max_spare_servers = 10
```

### srcs/requirements/nginx/Dockerfile
```
FROM alpine:latest

# Install necessary packages
RUN apk add --no-cache dumb-init nginx openssl

COPY ./conf/nginx.conf /etc/nginx/nginx.conf
COPY ./conf/default.conf /etc/nginx/http.d/default.conf

COPY ./tools/entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

ENTRYPOINT [ "/entrypoint.sh" ]

# 로그 파일 생성
# RUN echo "This is a log file" > /var/log/mylog.log

# # ENTRYPOINT 설정 - tail 명령어로 로그 파일을 계속해서 출력, 무한히 실행
# ENTRYPOINT ["tail", "-f", "/var/log/mylog.log"]
```

### srcs/requirements/nginx/tools/entrypoint.sh
```.sh
#!/bin/sh

set -e

# 파일 경로 설정
KEY_FILE_PATH="/etc/nginx/.key/Pri/nginx.key"
CRT_FILE_PATH="/etc/nginx/.key/Cert/nginx.crt"

# 인증서와 키 파일을 환경변수로부터 작성
mkdir -p "$(dirname "$KEY_FILE_PATH")"  # 디렉토리가 없으면 생성
mkdir -p "$(dirname "$CRT_FILE_PATH")"

echo "$SSL_KEY" > "$KEY_FILE_PATH"
echo "SSL key has been saved to $KEY_FILE_PATH"

echo "$SSL_CERT" > "$CRT_FILE_PATH"
echo "SSL certificate has been saved to $CRT_FILE_PATH"

# NGINX를 포그라운드 모드에서 실행하여 컨테이너가 계속 실행되도록 설정
exec nginx -g 'daemon off;'

```

### srcs/requirements/nginx/conf/default.conf
```.conf
server {
    listen 443 ssl default_server;
    listen [::]:443 ssl default_server;

    root /var/www/html/wordpress;
    index index.php index.html index.htm;

    # SSL 설정 (환경 변수를 참조)
    ssl_certificate /etc/nginx/.key/Cert/nginx.crt;
    ssl_certificate_key /etc/nginx/.key/Pri/nginx.key;

    # WordPress 기본 설정
    location / {
        try_files $uri $uri/ /index.php?$args;
    }

    # PHP 파일 처리 설정
    location ~ \.php$ {
        include fastcgi_params;
        fastcgi_pass 127.0.0.1:9000; # PHP-FPM의 주소와 포트
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    }

    # 로그 파일 설정
    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;
}

```

### srcs/requirements/nginx/conf/nginx.conf
```.conf
# /etc/nginx/nginx.conf

user nginx;

# Set number of worker processes automatically based on number of CPU cores.
worker_processes auto;

# Enables the use of JIT for regular expressions to speed-up their processing.
pcre_jit on;

# Configures default error logger.
error_log /var/log/nginx/error.log warn;

# Includes files with directives to load dynamic modules.
include /etc/nginx/modules/*.conf;

# Include files with config snippets into the root context.
include /etc/nginx/conf.d/*.conf;

events {
# The maximum number of simultaneous connections that can be opened by
# a worker process.
worker_connections 1024;
}

http {
# Includes mapping of file name extensions to MIME types of responses
# and defines the default type.
include /etc/nginx/mime.types;
default_type application/octet-stream;

# Name servers used to resolve names of upstream servers into addresses.
# It's also needed when using tcpsocket and udpsocket in Lua modules.
#resolver 1.1.1.1 1.0.0.1 [2606:4700:4700::1111] [2606:4700:4700::1001];

# Don't tell nginx version to the clients. Default is 'on'.
server_tokens off;

# Specifies the maximum accepted body size of a client request, as
# indicated by the request header Content-Length. If the stated content
# length is greater than this size, then the client receives the HTTP
# error code 413. Set to 0 to disable. Default is '1m'.
client_max_body_size 1m;

# Sendfile copies data between one FD and other from within the kernel,
# which is more efficient than read() + write(). Default is off.
sendfile on;

# Causes nginx to attempt to send its HTTP response head in one packet,
# instead of using partial frames. Default is 'off'.
tcp_nopush on;


# Enables the specified protocols. Default is TLSv1 TLSv1.1 TLSv1.2.
# TIP: If you're not obligated to support ancient clients, remove TLSv1.1.

# ssl_protocols TLSv1.1 TLSv1.2 TLSv1.3;
ssl_protocols TLSv1.2 TLSv1.3;


# Path of the file with Diffie-Hellman parameters for EDH ciphers.
# TIP: Generate with: `openssl dhparam -out /etc/ssl/nginx/dh2048.pem 2048`
#ssl_dhparam /etc/ssl/nginx/dh2048.pem;

# Specifies that our cipher suits should be preferred over client ciphers.
# Default is 'off'.
ssl_prefer_server_ciphers on;

# Enables a shared SSL cache with size that can hold around 8000 sessions.
# Default is 'none'.
ssl_session_cache shared:SSL:2m;

# Specifies a time during which a client may reuse the session parameters.
# Default is '5m'.
ssl_session_timeout 1h;

# Disable TLS session tickets (they are insecure). Default is 'on'.
ssl_session_tickets off;


# Enable gzipping of responses.
#gzip on;

# Set the Vary HTTP header as defined in the RFC 2616. Default is 'off'.
gzip_vary on;


# Helper variable for proxying websockets.
map $http_upgrade $connection_upgrade {
default upgrade;
'' close;
}


# Specifies the main log format.
log_format main '$remote_addr - $remote_user [$time_local] "$request" '
'$status $body_bytes_sent "$http_referer" '
'"$http_user_agent" "$http_x_forwarded_for"';

# Sets the path, format, and configuration for a buffered log write.
access_log /var/log/nginx/access.log main;


# Includes virtual hosts configs.
include /etc/nginx/http.d/*.conf;
}
```

